/*!
 * Minimal Toastify-like implementation for Eva Toast Notices.
 * This is NOT the official Toastify.js distribution but provides
 * a compatible-enough API for our usage without external deps.
 */
(function () {
  if (window.Toastify) {
    return;
  }

  function createElement(tag, className) {
    var el = document.createElement(tag);
    if (className) {
      el.className = className;
    }
    return el;
  }

  function Toastify(options) {
    options = options || {};

    var text = options.text || '';
    var duration = typeof options.duration === 'number' ? options.duration : 3000;
    var gravity = options.gravity === 'bottom' ? 'bottom' : 'top';
    var position = options.position === 'left' ? 'left' : (options.position === 'center' ? 'center' : 'right');
    var backgroundColor = options.backgroundColor || '';
    var close = !!options.close;
    var stopOnFocus = options.stopOnFocus !== false;
    var ariaRole = options.ariaRole || (gravity === 'top' ? 'alert' : 'status');
    var ariaLive = options.ariaLive || (gravity === 'top' ? 'assertive' : 'polite');
    var escapeMarkup = options.escapeMarkup !== false;

    var toast;
    var timeoutId;

    function showToast() {
      var containerId = 'eva-toast-container-' + gravity + '-' + position;
      var container = document.getElementById(containerId);
      if (!container) {
        container = createElement('div', 'eva-toastify-container eva-toastify-container-' + gravity + ' eva-toastify-container-' + position);
        container.id = containerId;
        container.setAttribute('role', 'region');
        container.setAttribute('aria-live', ariaLive);
        container.setAttribute('aria-atomic', 'false');
        document.body.appendChild(container);
      }

      toast = createElement('div', 'eva-toastify');
      toast.setAttribute('role', ariaRole);
      toast.setAttribute('tabindex', '0');

      if (backgroundColor) {
        toast.style.background = backgroundColor;
      }

      if (escapeMarkup) {
        toast.textContent = text;
      } else {
        toast.innerHTML = text;
      }

      if (close) {
        var closeBtn = createElement('button', 'eva-toastify-close');
        closeBtn.setAttribute('type', 'button');
        closeBtn.setAttribute('aria-label', 'Close notification');
        closeBtn.innerHTML = '&times;';
        closeBtn.addEventListener('click', function () {
          hideToast();
        });
        toast.appendChild(closeBtn);
      }

      if (stopOnFocus) {
        toast.addEventListener('mouseenter', function () {
          if (timeoutId) {
            clearTimeout(timeoutId);
          }
        });
        toast.addEventListener('mouseleave', function () {
          if (duration > 0) {
            timeoutId = setTimeout(hideToast, duration);
          }
        });
      }

      container.appendChild(toast);

      if (duration > 0) {
        timeoutId = setTimeout(hideToast, duration);
      }
    }

    function hideToast() {
      if (!toast) {
        return;
      }

      var parent = toast.parentNode;
      if (parent) {
        parent.removeChild(toast);
        if (!parent.hasChildNodes()) {
          parent.parentNode && parent.parentNode.removeChild(parent);
        }
      }
      toast = null;
    }

    return {
      showToast: showToast,
      hideToast: hideToast
    };
  }

  window.Toastify = Toastify;
}());


